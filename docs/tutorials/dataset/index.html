<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="generator" content="Docusaurus v2.0.0-alpha.56">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-135079836-3","auto"),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-135079836-3"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-135079836-3",{})</script><title data-react-helmet="true">Adding a dataset | MMF</title><meta data-react-helmet="true" property="og:image" content="https://mmf.sh/img/logo.png"><meta data-react-helmet="true" property="twitter:image" content="https://mmf.sh/img/logo.png"><meta data-react-helmet="true" name="twitter:image:alt" content="Image for MMF"><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:title" content="Adding a dataset | MMF"><meta data-react-helmet="true" name="description" content="[Outdated] A new version of this will be uploaded soon"><meta data-react-helmet="true" property="og:description" content="[Outdated] A new version of this will be uploaded soon"><meta data-react-helmet="true" property="og:url" content="https://mmf.sh/docs/tutorials/dataset"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.png"><link data-react-helmet="true" rel="canonical" href="https://mmf.sh/docs/tutorials/dataset"><link rel="stylesheet" href="/styles.f65714b6.css">
<link rel="preload" href="/styles.4b63bc84.js" as="script">
<link rel="preload" href="/runtime~main.e0dd4bba.js" as="script">
<link rel="preload" href="/main.edb813a7.js" as="script">
<link rel="preload" href="/1.69a7f423.js" as="script">
<link rel="preload" href="/2.fa7c8f67.js" as="script">
<link rel="preload" href="/34.1a9bb463.js" as="script">
<link rel="preload" href="/20ac7829.7f1e173c.js" as="script">
<link rel="preload" href="/02d6e213.378a39ff.js" as="script">
</head>
<body>
<div style="display: none; text-align: center; background-color: white; color: black;" id="internaldocs-banner"></div><div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/banner_logo.svg" alt="MMF Logo"><strong class="navbar__title"></strong></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs">Docs</a><a class="navbar__item navbar__link" href="/api_redirect">API</a><a href="https://github.com/facebookresearch/mmf" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a></div><div class="navbar__items navbar__items--right"></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/banner_logo.svg" alt="MMF Logo"><strong class="navbar__title"></strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/docs">Docs</a></li><li class="menu__list-item"><a class="menu__link" href="/api_redirect">API</a></li><li class="menu__list-item"><a href="https://github.com/facebookresearch/mmf" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_1kjD"><div class="docSidebarContainer_1cYp"><div class="sidebar_1kLs"><div class="menu menu--responsive menu_w2sC"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_2vk4" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="#!">Getting started</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/getting_started/installation">Installation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/getting_started/features">MMF Features</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/getting_started/quickstart">Quickstart</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/getting_started/video_overview">Video overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/getting_started/faqs">FAQs</a></li></ul></li><li class="menu__list-item"><a class="menu__link" href="#!">Notes</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/notes/concepts">Terminology and Concepts</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/notes/configuration">Configuration System</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/notes/training_tricks">Training Tricks</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/notes/dataset_zoo">Dataset Zoo</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/notes/model_zoo">Model Zoo</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/notes/pretrained_models">Pretrained Models</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/notes/projects">MMF Projects</a></li></ul></li><li class="menu__list-item"><a class="menu__link" href="#!">Tutorials</a><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/tutorials/dataset">Adding a dataset</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tutorials/concat_bert_tutorial">Adding a model - Concat BERT</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tutorials/checkpointing">Checkpointing</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tutorials/processors">Adding a Processor</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tutorials/slurm">Sweeping on Slurm</a></li></ul></li><li class="menu__list-item"><a class="menu__link" href="#!">Challenges</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/challenges/hateful_memes_challenge">Hateful Memes Challenge</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/challenges/textvqa_challenge">TextVQA Challenge</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/challenges/vqa_challenge">VQA Challenge</a></li></ul></li><li class="menu__list-item"><a class="menu__link" href="#!">Projects</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/projects/butd">BUTD</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/projects/m4c">M4C</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/projects/m4c_captioner">M4C-Captioner</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/projects/movie_mcan">Movie+MCAN (VQA 2020 Winner)</a></li></ul></li></ul></div></div></div><main class="docMainContainer_FFX1"><div class="container padding-vert--lg docItemWrapper_1cc7"><div class="row"><div class="col docItemCol_2GOA"><div class="docItemContainer_2cwg"><article><header><h1 class="docTitle_1vWb">Adding a dataset</h1></header><div class="markdown"><p><strong>[Outdated]</strong> A new version of this will be uploaded soon</p><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="mmf"></a>MMF<a aria-hidden="true" tabindex="-1" class="hash-link" href="#mmf" title="Direct link to heading">#</a></h1><p>This is a tutorial on how to add a new dataset to MMF.</p><p>MMF is agnostic to kind of datasets that can be added to it. On high level, adding a dataset requires 4 main components.</p><ul><li>Dataset Builder</li><li>Default Configuration</li><li>Dataset Class</li><li>Dataset&#x27;s Metrics</li></ul><p>In most of the cases, you should be able to inherit one of the existing datasets for easy integration. Let&#x27;s start from the dataset builder</p><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="dataset-builder"></a>Dataset Builder<a aria-hidden="true" tabindex="-1" class="hash-link" href="#dataset-builder" title="Direct link to heading">#</a></h1><p>Builder creates and returns an instance of :class:<code>mmf.datasets.base_dataset.BaseDataset</code> which is inherited from <code>torch.utils.data.dataset.Dataset</code>. Any builder class in MMF needs to be inherited from :class:<code>mmf.datasets.base_dataset_builder.BaseDatasetBuilder</code>. |BaseDatasetBuilder| requires user to implement following methods after inheriting the class.</p><ul><li><code>__init__(self):</code></li></ul><p>Inside this function call super().<strong>init</strong>(&quot;name&quot;) where &quot;name&quot; should your dataset&#x27;s name like &quot;vqa2&quot;.</p><ul><li><code>load(self, config, dataset_type, *args, **kwargs)</code></li></ul><p>This function loads the dataset, builds an object of class inheriting |BaseDataset| which contains your dataset logic and returns it.</p><ul><li><code>build(self, config, dataset_type, *args, **kwargs)</code></li></ul><p>This function actually builds the data required for initializing the dataset for the first time. For e.g. if you need to download some data for your dataset, this all should be done inside this function.</p><p>Finally, you need to register your dataset builder with a key to registry using <code>mmf.common.registry.registry.register_builder(&quot;key&quot;)</code>.</p><p>That&#x27;s it, that&#x27;s all you require for inheriting |BaseDatasetBuilder|.</p><p>Let&#x27;s write down this using example of <em>CLEVR</em> dataset.</p><p>.. code-block:: python</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">import json</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">import logging</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">import math</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">import os</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">import zipfile</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">from collections import Counter</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">from mmf.common.registry import registry</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">from mmf.datasets.base_dataset_builder import BaseDatasetBuilder</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># Let&#x27;s assume for now that we have a dataset class called CLEVRDataset</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">from mmf.datasets.builders.clevr.dataset import CLEVRDataset</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">from mmf.utils.general import download_file, get_mmf_root</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">logger = logging.getLogger(__name__)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">@registry.register_builder(&quot;clevr&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">class CLEVRBuilder(BaseDatasetBuilder):</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    DOWNLOAD_URL = &quot;&quot;https://dl.fbaipublicfiles.com/clevr/CLEVR_v1.0.zip&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def __init__(self):</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        # Init should call super().__init__ with the key for the dataset</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        super().__init__(&quot;clevr&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        # Assign the dataset class</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        self.dataset_class = CLEVRDataset</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def build(self, config, dataset):</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        download_folder = os.path.join(</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            get_mmf_root(), config.data_dir, config.data_folder</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        )</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        file_name = self.DOWNLOAD_URL.split(&quot;/&quot;)[-1]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        local_filename = os.path.join(download_folder, file_name)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        extraction_folder = os.path.join(download_folder, &quot;.&quot;.join(file_name.split(&quot;.&quot;)[:-1]))</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        self.data_folder = extraction_folder</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        # Either if the zip file is already present or if there are some</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        # files inside the folder we don&#x27;t continue download process</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        if os.path.exists(local_filename):</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            return</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        if os.path.exists(extraction_folder) and \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            len(os.listdir(extraction_folder)) != 0:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            return</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        logger.info(&quot;Downloading the CLEVR dataset now&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        download_file(self.DOWNLOAD_URL, output_dir=download_folder)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        logger.info(&quot;Downloaded. Extracting now. This can take time.&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        with zipfile.ZipFile(local_filename, &quot;r&quot;) as zip_ref:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            zip_ref.extractall(download_folder)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def load(self, config, dataset, *args, **kwargs):</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        # Load the dataset using the CLEVRDataset class</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        self.dataset = CLEVRDataset(</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            config, dataset, data_folder=self.data_folder</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        )</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return self.dataset</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def update_registry_for_model(self, config):</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        # Register both vocab (question and answer) sizes to registry for easy access to the</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        # models. update_registry_for_model function if present is automatically called by</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        # MMF</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        registry.register(</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            self.dataset_name + &quot;_text_vocab_size&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            self.dataset.text_processor.get_vocab_size(),</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        )</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        registry.register(</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            self.dataset_name + &quot;_num_final_outputs&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            self.dataset.answer_processor.get_vocab_size(),</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        )</span></div></div></div></div></div><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="default-configuration"></a>Default Configuration<a aria-hidden="true" tabindex="-1" class="hash-link" href="#default-configuration" title="Direct link to heading">#</a></h1><p>Some things to note about MMF&#x27;s configuration:</p><ul><li>Each dataset in MMF has its own default configuration which is usually under this structure <code>mmf/common/defaults/configs/datasets/[task]/[dataset].yaml</code> where <code>task</code> is the task your dataset belongs to.</li><li>These dataset configurations can be then included by the user in their end config using <code>includes</code> directive</li><li>This allows easy multi-tasking and management of configurations and user can also override the default configurations easily in their own config</li></ul><p>So, for CLEVR dataset also, we will need to create a default configuration.</p><p>The config node is directly passed to your builder which you can then pass to your dataset for any configuration that you need for building your dataset.</p><p>Basic structure for a dataset configuration looks like below:</p><p>.. code-block:: yaml</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">dataset_config:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    [dataset]:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        ... your config here</span></div></div></div></div></div><p>.. note:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">``processors`` in your dataset configuration are directly converted to attributes based on the key and are</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">automatically initialized with parameters mentioned in the config.</span></div></div></div></div></div><p>Here, is a default configuration for CLEVR needed based on our dataset and builder class above:</p><p>.. code-block:: yaml</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">dataset_config:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    # You can specify any attributes you want, and you will get them as attributes</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    # inside the config passed to the dataset. Check the Dataset implementation below.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    clevr:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        # Where your data is stored</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        data_dir: ${env.data_dir}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        data_folder: CLEVR_v1.0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        # Any attribute that you require to build your dataset but are configurable</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        # For CLEVR, we have attributes that can be passed to vocab building class</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        build_attributes:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            min_count: 1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            split_regex: &quot; &quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            keep:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                - &quot;;&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                - &quot;,&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            remove:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                - &quot;?&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                - &quot;.&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        processors:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        # The processors will be assigned to the datasets automatically by MMF</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        # For example if key is text_processor, you can access that processor inside</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        # dataset object using self.text_processor</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            text_processor:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                type: vocab</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                params:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    max_length: 10</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    vocab:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        type: random</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        vocab_file: vocabs/clevr_question_vocab.txt</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                # You can also specify a processor here</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                preprocessor:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    type: simple_sentence</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    params: {}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            answer_processor:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                # Add your processor for answer processor here</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                type: multi_hot_answer_from_vocab</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                params:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    num_answers: 1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    # Vocab file is relative to [data_dir]/[data_folder]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    vocab_file: vocabs/clevr_answer_vocab.txt</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    preprocessor:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        type: simple_word</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        params: {}</span></div></div></div></div></div><p>For processors, check :class:<code>mmf.datasets.processors</code> to understand how to create a processor and different processors that are already available in MMF.</p><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="dataset-class"></a>Dataset Class<a aria-hidden="true" tabindex="-1" class="hash-link" href="#dataset-class" title="Direct link to heading">#</a></h1><p>Next step is to actually build a dataset class which inherits |BaseDataset| so it can interact with PyTorch dataloaders. Follow the steps below to inherit and create your dataset&#x27;s class.</p><ul><li>Inherit :class:<code>mmf.datasets.base_dataset.BaseDataset</code></li><li>Implement <code>__init__(self, config, dataset)</code>. Call parent&#x27;s init using <code>super().__init__(&quot;name&quot;, config, dataset)</code> where &quot;name&quot; is the string representing the name of your dataset.</li><li>Implement <code>__getitem__(self, idx)</code>, our replacement for normal <code>__getitem__(self, idx)</code> you would implement for a torch dataset. This needs to return an object of class :class:Sample.</li><li>Implement <code>__len__(self)</code> method, which represents size of your dataset.</li><li>[Optional] Implement <code>load_item(self, idx)</code> if you need to load something or do something else with data and then call it inside <code>__getitem__</code>.</li></ul><p>.. note:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">Actual implementation of the dataset might differ due to support for distributed training.</span></div></div></div></div></div><p>.. code-block:: python</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">import os</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">import json</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">import numpy as np</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">import torch</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">from PIL import Image</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">from mmf.common.registry import registry</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">from mmf.common.sample import Sample</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">from mmf.datasets.base_dataset import BaseDataset</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">from mmf.utils.general import get_mmf_root</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">from mmf.utils.text import VocabFromText, tokenize</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">class CLEVRDataset(BaseDataset):</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def __init__(self, config, dataset, data_folder=None, *args, **kwargs):</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        super().__init__(&quot;clevr&quot;, config, dataset)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        self._data_folder = data_folder</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        self._data_dir = os.path.join(get_mmf_root(), config.data_dir)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        if not self._data_folder:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            self._data_folder = os.path.join(self._data_dir, config.data_folder)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        if not os.path.exists(self._data_folder):</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            raise RuntimeError(</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                &quot;Data folder {} for CLEVR is not present&quot;.format(self._data_folder)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            )</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        # Check if the folder was actually extracted in the subfolder</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        if config.data_folder in os.listdir(self._data_folder):</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            self._data_folder = os.path.join(self._data_folder, config.data_folder)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        if len(os.listdir(self._data_folder)) == 0:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            raise RuntimeError(&quot;CLEVR dataset folder is empty&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        self._load()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def _load(self):</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        self.image_path = os.path.join(self._data_folder, &quot;images&quot;, self._dataset_type)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        with open(</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            os.path.join(</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                self._data_folder,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                &quot;questions&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                &quot;CLEVR_{}_questions.json&quot;.format(self._dataset_type),</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            )</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        ) as f:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            self.questions = json.load(f)[&quot;questions&quot;]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            self._build_vocab(self.questions, &quot;question&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            self._build_vocab(self.questions, &quot;answer&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def __len__(self):</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        # __len__ tells how many samples are there</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return len(self.questions)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def _get_vocab_path(self, attribute):</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return os.path.join(</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            self._data_dir, &quot;vocabs&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;{}_{}_vocab.txt&quot;.format(self.dataset_name, attribute)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        )</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def _build_vocab(self, questions, attribute):</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        # This function builds vocab for questions and answers but not required for the</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        # tutorial</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        ...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def __getitem__(self, idx):</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        # Get item is like your normal __getitem__ in PyTorch Dataset. Based on id</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        # return a sample. Check VQA2Dataset implementation if you want to see how</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        # to do caching in MMF</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        data = self.questions[idx]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        # Each call to __getitem__ from dataloader returns a Sample class object which</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        # collated by our special batch collator to a SampleList which is basically</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        # a attribute based batch in layman terms</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        current_sample = Sample()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        question = data[&quot;question&quot;]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        tokens = tokenize(question, keep=[&quot;;&quot;, &quot;,&quot;], remove=[&quot;?&quot;, &quot;.&quot;])</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        # This processors are directly assigned as attributes to dataset based on the config</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        # we created above</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        processed = self.text_processor({&quot;tokens&quot;: tokens})</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        # Add the question as text attribute to the sample</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        current_sample.text = processed[&quot;text&quot;]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        processed = self.answer_processor({&quot;answers&quot;: [data[&quot;answer&quot;]]})</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        # Now add answers and then the targets. We normally use &quot;targets&quot; for what</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        # should be the final output from the model in MMF</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        current_sample.answers = processed[&quot;answers&quot;]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        current_sample.targets = processed[&quot;answers_scores&quot;]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        image_path = os.path.join(self.image_path, data[&quot;image_filename&quot;])</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        image = np.true_divide(Image.open(image_path).convert(&quot;RGB&quot;), 255)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        image = image.astype(np.float32)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        # Process and add image as a tensor</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        current_sample.image = torch.from_numpy(image.transpose(2, 0, 1))</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        # Return your sample and MMF will automatically convert it to SampleList before</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        # passing to the model</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return current_sample</span></div></div></div></div></div><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="metrics"></a>Metrics<a aria-hidden="true" tabindex="-1" class="hash-link" href="#metrics" title="Direct link to heading">#</a></h1><p>For your dataset to be compatible out of the box, it is a good practice to also add the metrics your dataset requires. All metrics for now go inside <code>MMF/modules/metrics.py</code>. All metrics inherit |BaseMetric| and implement a function <code>calculate</code> with signature <code>calculate(self, sample_list, model_output, *args, **kwargs)</code> where <code>sample_list</code> (|SampleList|) is the current batch and <code>model_output</code> is a dict return by your model for current <code>sample_list</code>. Normally, you should define the keys you want inside <code>model_output</code> and <code>sample_list</code>. Finally, you should register your metric to registry using <code>@registry.register_metric(&#x27;[key]&#x27;)</code> where &#x27;[key]&#x27; is the key for your metric. Here is a sample implementation of accuracy metric used in CLEVR dataset:</p><p>.. code-block: python</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">@registry.register_metric(&quot;accuracy&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">class Accuracy(BaseMetric):</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;&quot;&quot;Metric for calculating accuracy.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    **Key:** ``accuracy``</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;&quot;&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def __init__(self):</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        super().__init__(&quot;accuracy&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def calculate(self, sample_list, model_output, *args, **kwargs):</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        &quot;&quot;&quot;Calculate accuracy and return it back.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        Args:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            sample_list (SampleList): SampleList provided by DataLoader for</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                                current iteration</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            model_output (Dict): Dict returned by model.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        Returns:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            torch.FloatTensor: accuracy.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        &quot;&quot;&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        output = model_output[&quot;scores&quot;]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        expected = sample_list[&quot;targets&quot;]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        if output.dim() == 2:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            output = torch.max(output, 1)[1]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        # If more than 1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        if expected.dim() == 2:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            expected = torch.max(expected, 1)[1]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        correct = (expected == output.squeeze()).sum().float()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        total = len(expected)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        value = correct / total</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return value</span></div></div></div></div></div><p>These are the common steps you need to follow when you are adding a dataset to MMF.</p><p>.. |BaseDatasetBuilder| replace:: :class:<code>~mmf.datasets.base_dataset_builder.BaseDatasetBuilder</code> .. |BaseDataset| replace:: :class:<code>~mmf.datasets.base_dataset.BaseDataset</code> .. |SampleList| replace:: :class:<code>~mmf.common.sample.SampleList</code> .. |BaseMetric| replace:: :class:<code>~mmf.modules.metrics.BaseMetric</code></p></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/facebookresearch/mmf/edit/master/website/docs/tutorials/dataset.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 40 40" style="margin-right:0.3em;vertical-align:sub"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col text--right"><em><small>Last updated on <time datetime="2020-09-24T16:43:29.000Z" class="docLastUpdatedAt_1sqk">9/24/2020</time> by <strong>Amanpreet Singh</strong></small></em></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/notes/projects"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« MMF Projects</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/tutorials/concat_bert_tutorial"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Tutorial: Adding a model - Concat BERT »</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_TbNY"></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a href="https://medium.com/pytorch/bootstrapping-a-multimodal-project-using-mmf-a-pytorch-powered-multimodal-framework-464f75164af7" target="_blank" rel="noopener noreferrer" class="footer__link-item">Blog</a></li><li class="footer__item"><a href="https://github.com/facebookresearch/mmf" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Legal</h4><ul class="footer__items"><li class="footer__item"><a href="https://opensource.facebook.com/legal/privacy/" target="_blank" rel="noreferrer noopener" class="footer__link-item">Privacy</a></li><li class="footer__item"><a href="https://opensource.facebook.com/legal/terms/" target="_blank" rel="noreferrer noopener" class="footer__link-item">Terms</a></li></ul></div></div><div class="text--center"><div class="margin-bottom--sm"><a href="https://opensource.facebook.com" target="_blank" rel="noopener noreferrer" class="footerLogoLink_1Wg7"><img class="footer__logo" alt="Facebook Open Source Logo" src="/img/oss_logo.png"></a></div><div>Copyright © 2020 Facebook, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/styles.4b63bc84.js"></script>
<script src="/runtime~main.e0dd4bba.js"></script>
<script src="/main.edb813a7.js"></script>
<script src="/1.69a7f423.js"></script>
<script src="/2.fa7c8f67.js"></script>
<script src="/34.1a9bb463.js"></script>
<script src="/20ac7829.7f1e173c.js"></script>
<script src="/02d6e213.378a39ff.js"></script>
</body>
</html>